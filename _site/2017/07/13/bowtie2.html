<!DOCTYPE html>
<html lang="en">

<link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<head>
  <title>Bradford Condon, Developer and Bioinformaticist</title>
<meta charset="utf-8">
<meta name="author" content="Bradford Condon">
<meta name="description" content="Website, CV, and Blog of Bradford Condon.  Bradford is a web and mobile developer.  Bradford also holds a PhD in plant pathology and is an expert in genomics, bioinformatics.">
</head>
<section class="hero is-primary is-bold">
    <div class="hero-body">
        <div class="container">
            <h1 class="title">
                <a href="/" title="Home">
                    
                </a>
            </h1>
            <h2 class="subtitle">
                
            </h2>
        </div>

    </div>
    <div class="hero-foot">
        <nav class="tabs is-boxed nav-menu has-shadow">
            <div class="nav-center">
                <ul>

                    <li >
                    <a href="/">
          <span class="fa-stack fa-lg">
            <i class="fa fa-square-o fa-stack-2x"></i>
            <i class="fa fa-home fa-stack-1x"></i>
          </span>
                        Home</a></li>
                    <li >

                    <a href="/blog/">

          <span class="fa-stack fa-lg">
            <i class="fa fa-square-o fa-stack-2x"></i>
            <i class="fa fa-newspaper-o fa-stack-1x"></i>
          </span>
                        Blog</a>
                    </li>
                    <li >

                    <a href="/about/">
                   <span class="fa-stack fa-lg">
                      <i class="fa fa-square-o fa-stack-2x"></i>
                      <i class="fa fa-question fa-stack-1x"></i>
                    </span>
                        About</a>

                    </li>
                    <li >

                    <a href="/cv.html">
                    <span class="fa-stack fa-lg">
                        <i class="fa fa-square-o fa-stack-2x"></i>
                        <i class="fa fa-id-card fa-stack-1x"></i>
                   </span>
                        CV</a></li>
                </ul>
            </div>
        </nav>
    </div>
</section>
<link rel="stylesheet" href="/assets/css/application.css" />
<link rel="stylesheet" href="/assets/css/prism.css" />

<link rel="alternate" type="application/atom+xml" title="" href="/atom.xml">

<br/>

<body>
<div class="container content">
    <main>
        <div>
  <div class="box">
<article class="post">
  <h1 class="post-title">Examining bowtie output</h1>
 <time datetime="2017-07-13T00:00:00-04:00" class="post-date">13 Jul 2017</time>
  <div class="card-content">
  <p>This post is part 8 of a series on bioinformatics file formats, written for the 2017 UK-KBRIN Essentials of Next Generation Sequencing Workshop at the University of Kentucky.</p>

<h3 id="bowtie-output">Bowtie output</h3>

<p><a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml">The Bowtie 2 manual is available here</a>.</p>

<p>Bowtie 2 outputs SAM format.  A detailed explanation of the SAM format output is available <a href="http://samtools.sourceforge.net/SAM1.pdf">here</a>.</p>

<h3 id="example-output">Example output</h3>
<p>This example output is from <a href="http://genome.sph.umich.edu/wiki/SAM">the University of Michigan Center for Statistical Genomics</a></p>

<h4 id="header">Header</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>@HD	VN:1.0	SO:coordinate
@SQ	SN:1	LN:249250621	AS:NCBI37	UR:file:/data/local/ref/GATK/human_g1k_v37.fasta	M5:1b22b98cdeb4a9304cb5d48026a85128
@SQ	SN:2	LN:243199373	AS:NCBI37	UR:file:/data/local/ref/GATK/human_g1k_v37.fasta	M5:a0d9851da00400dec1098a9255ac712e
@SQ	SN:3	LN:198022430	AS:NCBI37	UR:file:/data/local/ref/GATK/human_g1k_v37.fasta	M5:fdfd811849cc2fadebc929bb925902e5
@RG	ID:UM0098:1	PL:ILLUMINA	PU:HWUSI-EAS1707-615LHAAXX-L001	LB:80	DT:2010-05-05T20:00:00-0400	SM:SD37743	CN:UMCORE
@RG	ID:UM0098:2	PL:ILLUMINA	PU:HWUSI-EAS1707-615LHAAXX-L002	LB:80	DT:2010-05-05T20:00:00-0400	SM:SD37743	CN:UMCORE
@PG	ID:bwa	VN:0.5.4
@PG	ID:GATK TableRecalibration	VN:1.0.3471	CL:Covariates=[ReadGroupCovariate, QualityScoreCovariate, CycleCovariate, DinucCovariate, TileCovariate], default_read_group=null, default_platform=null, force_read_group=null, force_platform=null, solid_recal_mode=SET_Q_ZERO, window_size_nqs=5, homopolymer_nback=7, exception_if_no_tile=false, ignore_nocall_colorspace=false, pQ=5, maxQ=40, smoothing=1
</code></pre>
</div>

<h4 id="body">Body</h4>

<p>The below example shows four alignments in SAM format.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>1:497:R:-272+13M17D24M	113	1	497	37	37M	15	100338662	0	CGGGTCTGACCTGAGGAGAACTGTGCTCCGCCTTCAG	0;==-==9;&gt;&gt;&gt;&gt;&gt;=&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;=&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;	XT:A:U	NM:i:0	SM:i:37	AM:i:0	X0:i:1	X1:i:0	XM:i:0	XO:i:0	XG:i:0	MD:Z:37
19:20389:F:275+18M2D19M	99	1	17644	0	37M	=	17919	314	TATGACTGCTAATAATACCTACACATGTTAGAACCAT	&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&gt;&gt;&gt;&lt;&lt;&gt;&gt;4::&gt;&gt;:&lt;9	RG:Z:UM0098:1	XT:A:R	NM:i:0	SM:i:0	AM:i:0	X0:i:4	X1:i:0	XM:i:0	XO:i:0	XG:i:0	MD:Z:37
19:20389:F:275+18M2D19M	147	1	17919	0	18M2D19M	=	17644	-314	GTAGTACCAACTGTAAGTCCTTATCTTCATACTTTGT	;44999;499&lt;8&lt;8&lt;&lt;&lt;8&lt;&lt;&gt;&lt;&lt;&lt;&lt;&gt;&lt;7&lt;;&lt;&lt;&lt;&gt;&gt;&lt;&lt;	XT:A:R	NM:i:2	SM:i:0	AM:i:0	X0:i:4	X1:i:0	XM:i:0	XO:i:1	XG:i:2	MD:Z:18^CA19
9:21597+10M2I25M:R:-209	83	1	21678	0	8M2I27M	=	21469	-244	CACCACATCACATATACCAAGCCTGGCTGTGTCTTCT	&lt;;9&lt;&lt;5&gt;&lt;&lt;&lt;&lt;&gt;&lt;&lt;&lt;&gt;&gt;&lt;&lt;&gt;&lt;&gt;&gt;&lt;9&gt;&gt;&lt;&gt;&gt;&gt;9&gt;&gt;&gt;&lt;&gt;	XT:A:R	NM:i:2	SM:i:0	AM:i:0	X0:i:5	X1:i:0	XM:i:0	XO:i:1	XG:i:2	MD:Z:35
</code></pre>
</div>

<p>Let’s look at just the first alignment.</p>

<p>The below table describes each field for the first alignment.</p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Alignment 1 Value</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>QNAME</td>
      <td>1:497:R:-272+13M17D24M</td>
      <td>Query name</td>
    </tr>
    <tr>
      <td>FLAG</td>
      <td>113</td>
      <td>A bitwise FLAG.</td>
    </tr>
    <tr>
      <td>RNAME</td>
      <td>1</td>
      <td>Reference name</td>
    </tr>
    <tr>
      <td>POS</td>
      <td>497</td>
      <td>Lefmost mapping position</td>
    </tr>
    <tr>
      <td>MAPQ</td>
      <td>37</td>
      <td>Mapping quality</td>
    </tr>
    <tr>
      <td>CIGAR</td>
      <td>37M</td>
      <td>CIGAR string ( see below)</td>
    </tr>
    <tr>
      <td>MRNM/RNEXT</td>
      <td>15</td>
      <td>Reference of the mate/next read</td>
    </tr>
    <tr>
      <td>MPOS/PNEXT</td>
      <td>100338662</td>
      <td>Position of mate/next read</td>
    </tr>
    <tr>
      <td>ISIZE/TLEN</td>
      <td>0</td>
      <td>Template length</td>
    </tr>
    <tr>
      <td>SEQ</td>
      <td>CGGGTCTGACCTGAGGAGAACTGTGCTCCGCCTTCAG</td>
      <td>Sequence</td>
    </tr>
    <tr>
      <td>QUAL</td>
      <td>0;==-==9;»»&gt;=»»»»»&gt;=»»»»»</td>
      <td>Phred-based quality score</td>
    </tr>
    <tr>
      <td>TAGS</td>
      <td>XT:A:U	NM:i:0	SM:i:37	AM:i:0	X0:i:1	X1:i:0	XM:i:0	XO:i:0 XG:i:0	MD:Z:37</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 id="flags-cigars-and-tags">FLAGs, CIGARs, and TAGS</h4>

<p>The FLAG, CIGAR, and TAGS fields all describe metadata associated with the alignment.  It’s likely that if you are interested in this information, you will search for a particular code, or perhaps will want to translate a code.  To that end, there are tools available to decode these fields.  For example, the broad institute has a <a href="https://broadinstitute.github.io/picard/explain-flags.html">FLAG-decoder in picard tools</a> that can convert FLAGs into human readable properties.</p>

<p>The FLAG and CIGAR fields are included as seperate apendices in the workshop.</p>

<h5 id="tags">TAGs</h5>

<p>TAGs take the form <code class="highlighter-rouge">[A-Za-z][A-za-z]:[AifZH]:.*</code>.</p>

  </div>
</article>
  </div>



 <div class="box">
<aside class="related">
  <h3>Related posts</h3>
  <ul class="related-posts">
    
      <li>
        <a href="/2018/09/23/tripal3_ajax_widgets.html">
          AJAX and widgets in Tripal 3
          <small><time datetime="2018-09-23T00:00:00-04:00">23 Sep 2018</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2018/08/26/read_the_docs.html">
          Documentation with Read the Docs
          <small><time datetime="2018-08-26T00:00:00-04:00">26 Aug 2018</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2018/06/08/module_showcase_site.html">
          Module showcase
          <small><time datetime="2018-06-08T00:00:00-04:00">08 Jun 2018</time></small>
        </a>
      </li>
    
  </ul>
</aside>
 </div>


   
 </div>
    </main>
</div>

<footer class="footer">
      <div class="container">

      <div class="content has-text-centered">
      <span>
        <a href="https://github.com/bradfordcondon"><i class="fa fa-github-square fa-3x"></i></a>
        <a href="https://twitter.com/BradfordCondon"><i class="fa fa-twitter-square fa-3x"></i></a>
        <a href="https://www.linkedin.com/in/bradford-condon-0843823b/"><i class="fa fa-linkedin-square fa-3x"></i></a>

        </span>
        </div>
              <div class="content has-text-centered">

          <p>
          <time datetime="2018-09-24T16:19:07-04:00"> Bradford Condon 2018</time>. Site and content provided under a <a href="https://creativecommons.org/licenses/by-nc/2.0/"> Creative Commons non-commercial 2.0 license</a>.  Proudly hosted on Github Pages. 
          </p> 
          </div>
      
        </div>
        
      </footer>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-71775012-1', 'auto');
    ga('send', 'pageview');

</script>
</body>
</html>
